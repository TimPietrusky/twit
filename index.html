<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Twit : The Custom Twitter Widget</title>
        <meta name="description" content="A custom ajax driven Twitter Client">
        <meta name="viewport" content="width=device-width">

        <!-- Place favicon.ico and apple-touch-icon.png in the root directory -->

        <link rel="stylesheet" href="css/normalize.css">
        <link rel="stylesheet" href="css/main.css">
        <script src="js/vendor/modernizr-2.6.1.min.js"></script>

        <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js"></script>
        <script>window.jQuery || document.write('<script src="js/vendor/jquery-1.8.0.min.js"><\/script>')</script>
        <script>
            //Twitter
            window.onload = function() {
                var ajax_load            = "<img class='loader' src='img/loading.gif' alt='Loading...' />",
                    twitter_preferences  = {
                                                count    : 4,
                                                username : 'gryghostvisuals'
                                            },
                    twitterUrl           = 'http://twitter.com/statuses/user_timeline.json?screen_name=' + twitter_preferences.username + '&callback=twitterCallback2&count=' + twitter_preferences.count,
                    script               = document.createElement('script');

                 $("#twitter_feed").html(ajax_load);

                 script.setAttribute('src', twitterUrl);

                 document.body.appendChild(script);
            }


            // Twitter Status Callback
            function twitterCallback2(tweet) {
                var statusHTML = [];

                for (var i=0; i < tweet.length; i++){
                    
                    var profileimageURL = tweet[i].user.profile_image_url,
                        username        = tweet[i].user.screen_name,
                        status          = tweet[i].text.replace(/((https?|s?ftp|ssh)\:\/\/[^"\s\<\>]*[^.,;'">\:\s\<\>\)\]\!])/g, function(url) { return '<a href="' + url + '">' + url + '</a>';

                        }).replace(/\B@([_a-z0-9]+)/ig, function(reply) { return  reply.charAt(0) + '<a href="http://twitter.com/' + reply.substring(1) + '">' + reply.substring(1) + '</a>';

                    });

                    statusHTML.push('<li class="twitter_meta"><span class="twitter_avatar"><a href="http://twitter.com/' + username + '/statuses/' + tweet[i].id_str + '"><img src="' + profileimageURL + '" alt=""></a></span> <span class="twitter_timestamp"><time pubdate><a href="http://twitter.com/' + username + '/statuses/' + tweet[i].id_str + '">' + relative_time(tweet[i].created_at) + '</a></time></span></li> <li class="twitter_tweet"><p>' + status + '</p></li>');
                }

                document.getElementById('twitter_update_list').innerHTML = statusHTML.join('');
            }


            // Twitter Time Stamp
            function relative_time(time_value) {

                var values      = time_value.split(" "),
                    parsed_date = new Date(),
                    months      = new Array('Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'),
                    m           = parsed_date.getMonth(),
                    postedAt    = '';

                time_value = values[1] + " " + values[2] + " " + values[5] + " " + values[3];
                parsed_date.setTime(Date.parse(time_value)); 

                postedAt = months[m];
                postedAt += " " + parsed_date.getDate();
                postedAt += ","
                postedAt += " " + parsed_date.getFullYear();

                return postedAt;
            }
        </script>
    </head>
    <body>
        <div id="twitter">
            <ul id="twitter_update_list">
                <li id="twitter_feed"></li>
            </ul>
        </div>
    </body>
</html>
